# I'm using this script to test my heatwave definitions across all my sitesimport pandas as pdfrom matplotlib import pyplot as plt# Print all columnspd.set_option('display.max_columns',None)# pd.set_option('display.max_rows',None) # be careful with this, can back up system# Load climatological datahistorical_data = pd.read_csv('/Users/marleeyork/Documents/project2/data/PRISM/extracted_daily_climate_data_wide_tmax.csv')historical_data.date = pd.to_datetime(historical_data.date)historical_data_Tmean = pd.read_csv('/Users/marleeyork/Documents/project2/data/extracted_daily_climate_data_wide_tmax.csv')historical_data_Tmean.date = pd.to_datetime(historical_data_Tmean.date)# Chcking what soil water content variables the sites haveswc_measures = ["SWC_F_MDS_1","SWC_F_MDS_2","SWC_F_MDS_3","SWC_F_MDS_4,SWC_F_MDS_5",                "SWC_F_MDS_1_QC","SWC_F_MDS_2_QC","SWC_F_MDS_3_QC","SWC_F_MDS_4_QC",                "SWC_F_MDS_5_QC"]shared_swc = find_shared_variables('/Users/marleeyork/Documents/project2/data/AMFdataDD',swc_measures)# Load in AmeriFlux hourly temperature dataAMF_data = loadAMF(path="/Users/marleeyork/Documents/project2/data/AMFdata_HH",                   measures=['TIMESTAMP_START','TA_F'])prec_data = loadAMF(path='/Users/marleeyork/Documents/project2/data/AMFdataDD',                    measures=['TIMESTAMP','P_F'])swc_data = loadAMF(path='/Users/marleeyork/Documents/project2/data/AMFdataDD',                   skip='/Users/marleeyork/Documents/project2/data/AMFdataDD/AMF_US-Ha1_FLUXNET_SUBSET_DD_1991-2020_3-5.csv',                   measures=['TIMESTAMP','SWC_F_MDS_1'])# There is missing data in swc_data, so we are going to remove thoseswc_data = swc_data[swc_data['SWC_F_MDS_1'] != -9999]# Initialize empty dictionaryheatwaves = {}# Loop through each site and define heatwavesfor site in AMF_data.Site.unique():    # Isolate site of interest in climatological and AMF data    historical_site_data = historical_data[['date',site]]    flux_data = AMF_data[AMF_data['Site']==site]    site_precip = prec_data[prec_data['Site']==site]    site_swc = swc_data[swc_data['Site']==site]        # Fit the heatwave defining function    site_heatwaves = fit_heatwaves(                      flux_dates = flux_data.TIMESTAMP_START,                       flux_temperature = flux_data.TA_F,                       historical_dates = historical_site_data['date'],                       historical_temperature = historical_site_data[site],                      quantile_threshold = .9,                      window_length = 15,                      threshold_comparison = 'greater',                      min_heatwave_length = 5,                      gap_days = 1,                      gap_days_window = 8,                      site = site                      )        # Getting precipitation conditions    site_heatwave_precip = calculate_moisture(        timeseries_dates = site_precip.TIMESTAMP,        timeseries_moisture = site_precip.P_F,        start_dates = site_heatwaves['start_dates'],        end_dates = site_heatwaves['end_dates']        )        site_heatwave_swc = calculate_moisture(        timeseries_dates = site_swc.TIMESTAMP,        timeseries_moisture = site_swc.SWC_F_MDS_1,        start_dates = site_heatwaves['start_dates'],        end_dates = site_heatwaves['end_dates']        )        # Add heatwaves into a dictionary with their site    heatwaves[site] = site_heatwaves    heatwaves[site]['precip'] = site_heatwave_moisture    heatwaves[site]['swc'] = site_heatwave_swc    # For each site, plot the heatwavesfor site in AMF_data.Site.unique():    print(site)    plt.show(heatwaves[site]["plot"])        # input("Press [enter] to continue...") # careful with this, can break things# Create a dataframe of all precip conditionsall_precip = pd.DataFrame(columns=['start_date','end_date','moisture_average','moisture_total','Site','Duration'])for site in AMF_data.Site.unique():    # Pull out moisture for the site    site_data = heatwaves[site]['precip']    # Add a site column    site_data['Site'] = [site]*len(site_data)    site_data['Duration'] = heatwaves[site]['summary'].duration    # Concat site data with all other data    all_precip = pd.concat([all_precip,site_data])    # Same for all SWC conditionsall_swc = pd.DataFrame(columns=['start_date','end_date','moisture_average','moisture_total','Site'])for site in AMF_data.Site.unique():    # Pull out moisture for the site    site_data = heatwaves[site]['swc']    # Add a site column    site_data['Site'] = [site]*len(site_data)    # Concat site data with all other data    all_swc = pd.concat([all_swc,site_data])all_swc = all_swc.dropna()# Plot distributions of all moisture datafig, ax = plt.subplots(1,3,figsize=(12,4))ax[0].set_title('Total Precipitation')ax[0].set_xlabel('Precipitation (mm)')ax[0].hist(all_precip['moisture_total'],bins=30)ax[1].hist(all_precip['moisture_average'],bins=30)ax[1].set_title('Average Precipitation')ax[1].set_xlabel('Precipitation (mm)')ax[2].hist(all_swc['moisture_average'],bins=30)ax[2].set_title('Average SWC')ax[2].set_xlabel('Precipitation (mm)')plt.show()# Histogram of durationfig, ax = plt.subplots()plt.hist(all_precip['Duration'])plt.show()# trying the EHF approach daily_flux_TA = loadAMF(path="/Users/marleeyork/Documents/project2/data/AMFdataDD",                   measures=['TIMESTAMP','TA_F'])